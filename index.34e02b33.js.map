{"mappings":"AAAA,MAAMA,KAAOC,SAASC,eAAe,OAC/BC,SAAWF,SAASC,eAAe,WACnCE,IAAM,2CAEZ,IAAIC,qBAEJ,MAAMC,iBAAmB,GAEnBC,uBAA0BC,IAC9BC,aAAaC,QAAQ,aAAcF,IAG/BG,QAAWC,IACf,MAAMC,EAAaC,KAAKC,MAAMN,aAAaO,QAAQ,eAEnDC,MADe,GAAGL,YAAcC,cAE7BK,MAAMC,GAAaA,EAASC,SAC5BF,MAAMG,IACL,IAAIC,EAASD,EACVE,KACEC,GACC,iEAYYA,EAAIC,OAAS,YAAAD,EAAAE,gDAE1BF,EAAYE,iCAEDF,EAAWG,2EAI/BC,KAAA,IACQC,EAAU5B,SAAE6B,cAAA,WAChBD,EAAME,UACRC,IAAM,S,EACDC,UAAAX,EACLtB,KAAAkC,YAAAL,M,OACIM,GAAAC,QAAiBC,IAAGF,M,SAExBG,MAAA9B,IAKF,G,uBAFmBA,G,QAClB6B,IAAA7B,GACDA,GAAA,UAAAG,QAAAP,SAEO,CACPC,qBAAuBkC,UAAIpC,UAEvB,IAAAqC,EAAsBvC,SAAK6B,cAAA,W,EACfC,UAAcC,IAAE,U,EAClBC,UACJ,uD,KAGHC,YAAAM,K,SAIHC,iB,qBAEF,IAAAC,sBAAAC,IACFA,EAAAC,SAAqBC,IACtB,GAAAA,EAAAC,eAAA,CAEM,MAAAC,EAEJjC,KAAUC,MAAAN,aAAAO,QAAA,kBACTgC,SAAiBD,EAxEI,UA8EvB,CACCE,WAAA,mBACIC,UAAA,IAEJ7C,qBAAA8C,QAAAhD,U","sources":["src/index.js"],"sourcesContent":["const $app = document.getElementById(\"app\");\r\nconst $observe = document.getElementById(\"observe\");\r\nconst API = \"https://api.escuelajs.co/api/v1/products\";\r\n\r\nlet intersectionObserver;\r\n\r\nconst PAGINATION_LIMIT = 10;\r\n\r\nconst setPaginationInStorage = (offset) => {\r\n  localStorage.setItem(\"pagination\", offset);\r\n};\r\n\r\nconst getData = (api) => {\r\n  const pagination = JSON.parse(localStorage.getItem(\"pagination\"));\r\n  const apiUrl = `${api}?offset=${pagination}&limit=${PAGINATION_LIMIT}`;\r\n  fetch(apiUrl)\r\n    .then((response) => response.json())\r\n    .then((products) => {\r\n      let output = products\r\n        .map(\r\n          (product) =>\r\n            `\r\n            <article class=\"Card\">\r\n              <img src=\"${product.images[0]}\" alt=\"${product.title}\">\r\n              <h2>\r\n                ${product.title}\r\n                <small>${product.price}</small>\r\n              </h2>\r\n            </article>\r\n          `\r\n        )\r\n        .join(\"\");\r\n      let newItem = document.createElement(\"section\");\r\n      newItem.classList.add(\"Items\");\r\n      newItem.innerHTML = output;\r\n      $app.appendChild(newItem);\r\n    })\r\n    .catch((error) => console.log(error));\r\n};\r\n\r\nconst loadData = async (offset) => {\r\n  setPaginationInStorage(offset);\r\n  console.log(offset);\r\n  if (offset <= 200) {\r\n    await getData(API);\r\n  } else {\r\n    intersectionObserver.unobserve($observe);\r\n    let endOfItemsMessage = document.createElement(\"section\");\r\n    endOfItemsMessage.classList.add(\"Center\");\r\n    endOfItemsMessage.innerHTML = `\r\n      <h1>Todos los productos Obtenidos</h1>\r\n    `;\r\n    $app.appendChild(endOfItemsMessage);\r\n  }\r\n};\r\n\r\nfunction createObserver() {\r\n  intersectionObserver = new IntersectionObserver(\r\n    (entries) => {\r\n      entries.forEach((entry) => {\r\n        if (entry.isIntersecting) {\r\n          const actualOffset =\r\n            JSON.parse(localStorage.getItem(\"pagination\")) || 0;\r\n          loadData(actualOffset + PAGINATION_LIMIT);\r\n        }\r\n      });\r\n    },\r\n    {\r\n      rootMargin: \"0px 0px 100% 0px\",\r\n      threshold: 1.0,\r\n    }\r\n  );\r\n  intersectionObserver.observe($observe);\r\n}\r\n\r\nwindow.addEventListener(\r\n  \"load\",\r\n  (event) => {\r\n    createObserver();\r\n  },\r\n  false\r\n);\r\n\r\nwindow.addEventListener(\"beforeunload\", function () {\r\n  return localStorage.clear(), setPaginationInStorage(0);\r\n});\r\nwindow.addEventListener(\"beforereload\", function () {\r\n  return localStorage.clear(), setPaginationInStorage(0);\r\n});\r\n"],"names":["$app","document","getElementById","$observe","API","intersectionObserver","PAGINATION_LIMIT","setPaginationInStorage","offset","localStorage","setItem","getData","api","pagination","JSON","parse","getItem","fetch","then","response","json","products","output","map","product","images","title","price","join","newItem","createElement","classList","add","innerHTML","appendChild","error","console","log","async","unobserve","endOfItemsMessage","createObserver","IntersectionObserver","entries","forEach","entry","isIntersecting","actualOffset","loadData","rootMargin","threshold","observe"],"version":3,"file":"index.34e02b33.js.map"}