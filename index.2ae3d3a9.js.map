{"mappings":"AAAA,MAAMA,KAAOC,SAASC,eAAe,OAC/BC,SAAWF,SAASC,eAAe,WACnCE,IAAM,2CAEZ,IAAIC,qBAEJ,MAAMC,uBAAyB,CAACC,EAAQC,KACtC,MAAMC,EAAa,CACjBF,SACAC,SAEFE,aAAaC,QAAQ,aAAcC,KAAKC,UAAUJ,KAG9CK,QAAWC,IACf,MAAMN,EAAaG,KAAKI,MAAMN,aAAaO,QAAQ,eAC7CC,EAAS,GAAGH,YAAcN,EAAWF,gBAAgBE,EAAWD,QACtEW,MAAMD,GACHE,MAAMC,GAAaA,EAASC,SAC5BF,MAAMG,IACL,IAAIC,EAASD,EACVE,KACEC,GACC,iEAYYA,EAAIC,OAAS,YAAAD,EAAAE,gDAE1BF,EAAYE,iCAEDF,EAAWG,2EAI/BC,KAAA,IACIC,EAAa9B,SACT+B,cAAa,W,EACdC,UAAAC,IAAA,SACLH,EAAAI,UAAoBX,EACpBxB,KAAIoC,YAAAL,M,OACJM,GAAAC,QAAkBC,IAAAF,M,SAIbG,MAAWjC,EAACC,KAEnB,G,uBADCD,EAAAC,GACDD,GAAA,UAAAO,QAAAV,SAEO,CACPC,qBAAuBoC,UAAItC,UAEvB,IAAAuC,EAAsBzC,SAAK+B,cAAA,W,EACfC,UAAcC,IAAE,U,EAClBC,UAAgB,uD,KAQvBC,YAAAM,K,SAIHC,iB,qBAEF,IAAAC,sBAAAC,IACFA,EAAAC,SAAqBC,IACtB,GAAAA,EAAAC,eAAA,CAEM,MAAAC,EAEMrC,KAAAI,MAAAN,aAAAO,QAAA,eACGiC,SAASD,EAAM1C,OAAA0C,EAAAzC,MAAAyC,EAAAzC,aAI7B,C","sources":["src/index.js"],"sourcesContent":["const $app = document.getElementById(\"app\");\r\nconst $observe = document.getElementById(\"observe\");\r\nconst API = \"https://api.escuelajs.co/api/v1/products\";\r\n\r\nlet intersectionObserver;\r\n\r\nconst setPaginationInStorage = (offset, limit) => {\r\n  const pagination = {\r\n    offset,\r\n    limit,\r\n  };\r\n  localStorage.setItem(\"pagination\", JSON.stringify(pagination));\r\n};\r\n\r\nconst getData = (api) => {\r\n  const pagination = JSON.parse(localStorage.getItem(\"pagination\"));\r\n  const apiUrl = `${api}?offset=${pagination.offset}&limit=${pagination.limit}`;\r\n  fetch(apiUrl)\r\n    .then((response) => response.json())\r\n    .then((products) => {\r\n      let output = products\r\n        .map(\r\n          (product) =>\r\n            `\r\n            <article class=\"Card\">\r\n              <img src=\"${product.images[0]}\" alt=\"${product.title}\">\r\n              <h2>\r\n                ${product.title}\r\n                <small>${product.price}</small>\r\n              </h2>\r\n            </article>\r\n          `\r\n        )\r\n        .join(\"\");\r\n      let newItem = document.createElement(\"section\");\r\n      newItem.classList.add(\"Items\");\r\n      newItem.innerHTML = output;\r\n      $app.appendChild(newItem);\r\n    })\r\n    .catch((error) => console.log(error));\r\n};\r\n\r\nconst loadData = async (offset, limit) => {\r\n  setPaginationInStorage(offset, limit);\r\n  if (offset <= 200) {\r\n    await getData(API);\r\n  } else {\r\n    intersectionObserver.unobserve($observe);\r\n    let endOfItemsMessage = document.createElement(\"section\");\r\n    endOfItemsMessage.classList.add(\"Center\");\r\n    endOfItemsMessage.innerHTML = `\r\n      <h1>Todos los productos Obtenidos</h1>\r\n    `;\r\n    $app.appendChild(endOfItemsMessage);\r\n  }\r\n};\r\n\r\nfunction createObserver() {\r\n  intersectionObserver = new IntersectionObserver(\r\n    (entries) => {\r\n      entries.forEach((entry) => {\r\n        if (entry.isIntersecting) {\r\n          const actualPagination = JSON.parse(\r\n            localStorage.getItem(\"pagination\")\r\n          );\r\n          loadData(\r\n            actualPagination.offset + actualPagination.limit,\r\n            actualPagination.limit\r\n          );\r\n        }\r\n      });\r\n    },\r\n    {\r\n      rootMargin: \"0px 0px 100% 0px\",\r\n      threshold: 1.0,\r\n    }\r\n  );\r\n  intersectionObserver.observe($observe);\r\n}\r\n\r\nwindow.addEventListener(\r\n  \"load\",\r\n  (event) => {\r\n    loadData(5, 10).then(() => {\r\n      createObserver();\r\n    });\r\n  },\r\n  false\r\n);\r\n"],"names":["$app","document","getElementById","$observe","API","intersectionObserver","setPaginationInStorage","offset","limit","pagination","localStorage","setItem","JSON","stringify","getData","api","parse","getItem","apiUrl","fetch","then","response","json","products","output","map","product","images","title","price","join","newItem","createElement","classList","add","innerHTML","appendChild","error","console","log","async","unobserve","endOfItemsMessage","createObserver","IntersectionObserver","entries","forEach","entry","isIntersecting","actualPagination","loadData"],"version":3,"file":"index.2ae3d3a9.js.map"}